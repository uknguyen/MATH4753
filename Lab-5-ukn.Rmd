---
title: "Lab 5-ukn"
author: "U Kristine Nguyen"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Tasks

## Task 1

```{r}
getwd()
```

## Task 2

```{r}
mybin = function(iter = 1000, n = 10, p = 0.5){
  sam.mat = matrix(NA, nrow = n, ncol = iter, byrow = TRUE)
  succ = c()
  for (i in 1:iter){
    sam.mat[,i] = sample(c(1,0), n, replace = TRUE, prob = c(p, 1-p))
    succ[i] = sum(sam.mat[,i])
  }
  
  succ.tab = table(factor(succ, levels = 0:n))
  
  iter.lab = paste0("iter = ", iter)
  n.lab = paste0("n = ", n)
  p.lab = paste0("p = ", p)
  lab = paste(iter.lab, n.lab, p.lab, sep = ", ")
  barplot(succ.tab / (iter), col = rainbow(n+1), main = "Binomial Simulation", sub = lab, xlab = "The Number of Successes")
  succ.tab/iter
}
```

### (a) 100 interations

```{r}
bin100 <- mybin(iter = 100, n = 10, p = 0.7)
```

### (b) 200 iterations

```{r}
bin200 <- mybin(iter = 200, n = 10, p = 0.7)
```

### (c) 500 iterations

```{r}
bin500 <- mybin(iter = 500, n = 10, p = 0.7)
```

### (d) 1,000 iterations

```{r}
bin1k <- mybin(iter = 1000, n = 10, p = 0.7)
```

### (e) 10,000 iterations

```{r}
mybin(iter = 10000, n = 10, p = 0.7)
```

#### iter = 10,000 table above

### (f) Verify approximate values

```{r}
db.tab = round(dbinom(0:10, size = 10, prob = 0.7), 4)
names(db.tab) = 0:10
db.tab
```

  The values for 10,000 iterations and the values for dbinom are approximately the same.
  
## Task 3

### (a) Creating sample with n = 5 and no replacement.

```{r}
sample(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0), size = 5, replace = FALSE, prob = NULL)
```

### (b) Creating sample with n = 5 and replacement.

```{r}
sample(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0), size = 5, replace = TRUE, prob = NULL)
```

### (c) Using myhyper() to make barplots of Y

```{r}
myhyper = function(iter = 100, N = 20, r = 12, n = 5) {
  sam.mat = matrix(NA, nrow = n, ncol = iter, byrow = TRUE)
  succ = c()
  
  for(i in 1:iter) {
    sam.mat[,i] = sample(rep(c(1,0), c(r, N - r)), n, replace = FALSE)
    succ[i] = sum(sam.mat[,i])
  }
  succ.tab = table(factor(succ, levels = 0:n))
  
  iter.lab = paste0("iter = ", iter)
  N.lab = paste0("N = ", N)
  r.lab = paste0("r = ", r)
  n.lab = paste0("n = ", n)
  lab = paste(iter.lab, N.lab, r.lab, n.lab, sep = ", ")
  barplot(succ.tab / (iter), col = rainbow(n+1), main = "Hypergeometric Simulation", sub = lab, xlab = "The Number of Successes")
  succ.tab / iter
}
```

#### (i) 100 interations

```{r}
hype100 = myhyper(iter = 100)
```

#### (ii) 200 iterations

```{r}
hype200 = myhyper(iter = 200)
```

#### (iii) 500 iterations

```{r}
hype500 = myhyper(iter = 500)
```

#### (iv) 1,000 iterations

```{r}
hype1k = myhyper(iter = 1000)
```

#### (v) 10,000 iterations

```{r}
myhyper(iter = 10000)
```

##### iter = 10,000 table above

### (d) Verify approximate values

```{r}
dhype.tab = round(dhyper(x = 0:5, m = 12, n = 8, k = 5), 4)
names(dhype.tab) = 0:5
dhype.tab
```

  The values for 10,000 iterations and the values for dhyper are approximately the same.
  
## Task 4
  The function "mysample()" is supposed to create a sample with size _n_ by choosing random numbers from 1 to 10, _iter_ times. Each sample makes a barplot, and the time between each run is the _time_ parameter. Once the sample is created, there's a factor variable _sf_ that counts the how many times each number occurs.
  
```{r}
mysample = function(n, iter = 10, time = 0.5) {
  for(i in 1:iter) {
    s = sample(1:10, n, replace = TRUE)
    sf = factor(s, levels = 1:10)
    barplot(table(sf)/n, beside = TRUE, col = rainbow(10), main = paste("Example sample()", "iteration", i, "n = ", n, sep = " "), ylim = c(0, 0.2)
    )
    Sys.sleep(time)
  }
}
mysample(n = 1000, iter = 30, time = 1)
```

  The "mysample()" function releases a new barplot for each iteration of the sample each second. The average value for the distributions consistently stay around 0.10.
  
## Task 5

### (a) 

```{r}
choose(8, 4)
```

  $$\left( \begin{array}
  {r}
  8 \\
  4
  \end{array}
  \right) = 70$$
  
### (b)

```{r}
1 - ppois(q = 3, lambda = 2)
```

  $P(P>4), Y \sim Pois(\lambda = 2) = 0.1429$

### (c)

```{r}
choose(10 - 1, 3 - 1)* 0.4 ^ 3 * 0.6 ^ (10-3)
nbp = dnbinom(x = 10 - 3, size = 3, prob = 0.4)
```

  $P(Y = 10), Y \sim NegBin (p = 0.4, size = 3) = 0.0644973$
  
### (d)

```{r}
pbinom(q = 8, size = 15, prob = 0.4)
```

  $P(Y \leq 8), Y \sim Bin(n = 15, p = 0.4) = 0.9050$
  
## Task 6

```{r}
package1::binx()
```

