---
title: "Lab 9-ukn"
author: "U Kristine Nguyen"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1

```{r}
getwd()
```

# Task 2

## (a) Explaining code

### (i) Explaining line A in "myboot()"

Line A is creating a sample with the variables provided as well as the n generated with "n = length(x)." It also allows replacement with the sample. The sample is placed in vector "y."

### (ii) Explaining line B in "myboot()"

Line B forms a confidence interval using the alpha provided and the xstat generated with "xstat = apply(rs.mat,2,fun)." The confidence interval is placed in vector "ci."

## (b) Why is it necessary?

It's necessary for each value for x to have equal probability of occuring so that it is both Random and Independent of each other.

## (c) Unique Sample

### (i) Sample w/ Replacement

```{r}
set.seed(35)
sam = round(rnorm(20, mean = 10, sd = 4), 2)

unique(sample(sam, 20, replace = TRUE))
unique(sample(sam, 20, replace = TRUE))
unique(sample(sam, 20, replace = TRUE))
unique(sample(sam, 20, replace = TRUE))
unique(sample(sam, 20, replace = TRUE))
```

### (ii) Explain

The code produces 5 sets of samples. The first sample has 12 data points, the second samples has 15 data points, the third sample has 11 data points, the fourth sample has 10 data points, and the fifth sample has 12 data points. 

Since the data for each sample is coming from the same population generated by rnorm(), there are some number values that are the same in different samples, but the order in which they occur is shuffled up. This is because replacement is true for the unique sample but order is false.

### (iii) Sample w/ No Replacement

```{r}
sample(sam, 20, replace = FALSE)
```

### (iv)

All 20 numbers from the sample is generated.This is probably because there is no replacement allowed and the sample calls for 20 data points. 

The document for Lab 9 said to use sample(sam, 21, replace = FALSE) but there was an error because the sample was larger than the population used to generate the sample

# Task 3

## (a) 95% confidence, alpha = 0.05, inter = 10000

### (i) myboot()

```{r}
myboot <- function(iter = 10000, x, fun = "mean", alpha = 0.05,...){
  n = length(x)
  
  y = sample(x, n*iter, replace = TRUE)
  
  rs.mat = matrix(y, nr = n, nc = iter, byrow = TRUE)
  xstat = apply(rs.mat, 2, fun)
  
  ci = quantile(xstat, c(alpha/2, 1-alpha/2))
  
  para = hist(xstat, freq = FALSE, las = 1, main = "Histogram of Bootstrap Sample Statistics",...)
  
  mat = matrix(x, nr = length(x), nc = 1, byrow = TRUE)
  
  pte = apply(mat, 2, fun)
  abline (v = pte, lwd = 3, col = "Blue")
  segments(ci[1], 0, ci[2], 0, lwd = 4)
  text(ci[1], 0, paste("(", round(ci[1],2), sep = ""), col = "Purple", cex = 3)
  text(ci[2], 0, paste(round(ci[2],2), ")", sep = ""), col = "Purple", cex = 3)
  
  text(pte, max(para$density)/2, round(pte, 2), cex = 3)
  
  return(list(ci = ci, fun = fun, x = x))
}
```

### (ii)

```{r}
set.seed(39)
samA = rnorm(25, mean = 25, sd = 10)

plA = myboot(x = samA)

mn = 25
```

The difference between the point estimate and population mean is approximately 2.12. The population mean is included in the interval.

### (iii)

```{r}
set.seed(30)
samB = rchisq(20, df = 3)

plB = myboot(x = samB)

mc = 3
```

The difference between the point estimate and population mean is about 0.06. The population mean is included in the interval.

### (iv)

```{r}
set.seed(40)
samC = rgamma(30, shape = 2, scale = 3)

plC = myboot(x = samC)

#alpha * beta
mg = 6
```

The difference between the point estimate and the population mean is about 0.5. The population mean is included in the interval.

### (v)

```{r}
set.seed(10)
samD = rbeta(20, shape1 = 3, shape2 = 4)

plD = myboot(x = samD)

#alpha/(alpha+beta)
mb = 3/7
mb
```

The difference between the population mean and point estimate is about 0.02. The population mean is included in the interval.

## (b) 80% confidence, alpha = 0.20, inter = 10000

### (i)

```{r}
set.seed(39)
sama = rnorm(25, mean = 25, sd = 10)

pla = myboot(x = sama, alpha = 0.20)
```

### (ii)

```{r}
set.seed(30)
samb = rchisq(20, df = 3)

plb = myboot(x = samb, alpha = 0.20)
```

### (iii)

```{r}
set.seed(40)
samc = rgamma(30, shape = 2, scale = 3)

plc = myboot(x = samc, alpha = 0.20)
```

### (iv)

```{r}
set.seed(10)
samd = rbeta(20, shape1 = 3, shape2 = 4)

pld = myboot(x = samd, alpha = 0.20)
```


# Task 4

```{r}
myboota <- function(iter = 10000, x, fun = "mean", alpha = 0.05,...){
  n = length(x)
  
  y = sample(x, n*iter, replace = TRUE)
  
  rs.mat = matrix(y, nr = n, nc = iter, byrow = TRUE)
  xstat = apply(rs.mat, 2, fun)
  
  ci = quantile(xstat, c(alpha/2, 1-alpha/2))
  
  para = hist(xstat, freq = FALSE, las = 1, main = "Histogram of Bootstrap Sample Statistics",...)
  
  mat = matrix(x, nr = length(x), nc = 1, byrow = TRUE)
  
  pte = apply(mat, 2, fun)
  abline(v = pte, lwd = 3, col = "Blue")
  segments(ci[1], 0, ci[2], 0, lwd = 4)
  text(ci[1], 0, paste("(", round(ci[1],2), sep = ""), col = "Purple", cex = 3)
  text(ci[2], 0, paste(round(ci[2],2), ")", sep = ""), col = "Purple", cex = 3)
  
  text(pte, max(para$density)/2, round(pte, 2), cex = 3)
  
  return(list(ci = ci, fun = fun, x = x, pte = pte))
}

samff = c(1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 4, 4)

myboota(x = samff, fun = "median")
```

The interval is (1.5, 3)

# Task 5

## (a) 95% Confidence

### (i)

```{r}
set.seed(39)
samaa = rnorm(25, mean = 25, sd = 10)

t.test(x = samaa, mu = mn/23.88, conf.level = 0.95)$"conf.int"
```

### (ii)

```{r}
set.seed(30)
sambb = rchisq(20, df = 3)

t.test(x = sambb, mu = mc/2.94, conf.level = 0.95)$"conf.int"
```

### (iii)

```{r}
set.seed(40)
samcc = rgamma(30, shape = 2, scale = 3)

t.test(x = samcc, mu = mg/6.5, conf.level = 0.95)$"conf.int"
```

### (iv)

```{r}
set.seed(10)
samdd = rbeta(20, shape1 = 3, shape2 = 4)

t.test(x = samdd, mu = mb/0.41, conf.level = 0.95)$"conf.int"
```

## (b)

### (i)

```{r}
t.test(x = samaa, mu = mn/23.88, conf.level = 0.70)$"conf.int"
```

### (ii)

```{r}
t.test(x = sambb, mu = mc/2.94, conf.level = 0.70)$"conf.int"
```

### (iii)

```{r}
t.test(x = samcc, mu = mg/6.5, conf.level = 0.70)$"conf.int"
```

### (iv)

```{r}
t.test(x = samdd, mu = mb/0.41, conf.level = 0.70)$"conf.int"
```

# Task 6

## (a) Cauchy distribution

```{r}
set.seed(18)
samcauchy = rcauchy(20)

myboot(x = samcauchy, alpha = 0.20)
```

## (b) Exponential distribution

```{r}
set.seed(18)
samexp = rexp(20)

myboot(x = samexp, alpha = 0.20)
```

## (c) F distribution

```{r}
set.seed(18)
samf = rf(20, df1= 3, df2 = 2)

myboot(x = samf, alpha = 0.20)
```

## (d) Wilcoxon Signed Rank Distribution

```{r}
set.seed(18)
sams = rsignrank(100, 20)

myboot(x = sams, alpha = 0.20)
```

# Task 7

```{r}
myboot2<-function(iter=10000,x,fun="mean",alpha=0.05,cx=1.5,...){

  n=length(x)

  y=sample(x,n*iter,replace=TRUE)
  rs.mat=matrix(y,nr=n,nc=iter,byrow=TRUE)
  xstat=apply(rs.mat,2,fun) 
  ci=quantile(xstat,c(alpha/2,1-alpha/2))
  para = hist(xstat,freq=FALSE,las=1,
  main = paste("Histogram of Bootstrap sample statistics","\n","alpha=",alpha," iter=",iter,sep=""), ...)

  mat=matrix(x,nr=length(x),nc=1,byrow=TRUE)

  pte=apply(mat,2,fun)
  abline(v=pte,lwd=3,col="Black")
  segments(ci[1],0,ci[2],0,lwd=4)
  text(ci[1],0,paste("(",round(ci[1],2),sep=""),col="Red",cex=cx)
  text(ci[2],0,paste(round(ci[2],2),")",sep=""),col="Red",cex=cx)

  text(pte,max(para$density)/2,round(pte,2),cex=cx)

  invisible(list(ci=ci,fun=fun,x=x))
}
```

## (a)

```{r}
set.seed(68)
samn = rnorm(20, mean = 10, sd = 4)

t.test(samn, conf.level = 0.95)$"conf.int"
```

## (b)

```{r}
myboot2(x = samn)
```

## (c)

The confidence interval with 95% confidence for t.test() is slightly higher than the confidence interval with 95% confidence for myboot2().

# Task 8

```{r}
library(package1)
library(Intro2R)
package1::myboot2(x = ddt$DDT)
```

