---
title: "Lab 3: MATH 4753"
author: "U Kristine Nguyen"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1

```{r}
getwd()
```

# Task 2

```{r}
spr <- read.csv("SPRUCE.csv")
head(spr)
```

# Task 3

## a. Scatter plot

```{r}
plot(Height~BHDiameter, bg = "Blue", pch=21, cex=1.2, 
     main = "Tree Height vs BHDiameter", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr)
```

  There appears to be a relatively straight line relationship

## b. Trendscatter

```{r}
library(s20x)
layout(matrix(1:3, nr = 3, nc = 1, byrow = TRUE))
tsone = trendscatter(Height~BHDiameter, f=0.5, data = spr)
tstwo = trendscatter(Height~BHDiameter, f=0.6, data = spr)
tsthree = trendscatter(Height~BHDiameter, f=0.7, data = spr)
```

## c. Linear Model/Least Squares Regression Line

```{r}
spruce.lm = with(spr, lm(Height~BHDiameter))
lo = layout(1)
with(spr,
     plot(Height~BHDiameter, bg = "Blue", pch=21, cex=1.2, 
     main = "Tree Height vs BHDiameter", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr))
     abline(spruce.lm)
```

  The straight line is not appropriate because there are too many points that are far away from the LSR line. A curved line would be best fitted for the scatter plot.

# Task 4

## a. Plots of RSS, MSS, and TSS

```{r}
lo = layout(matrix(1:4, nr = 2, nc = 2, byrow = TRUE))
layout.show(4)

mycex = 1.0

# Scatterplot

with(spr,
     plot(Height~BHDiameter, bg = "Blue", pch = 21, cex = mycex, 
     main = "Tree Height vs BHDiameter", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr))
     abline(spruce.lm)
     
#Residual Sum of Squares
   
yhat = fitted(spruce.lm)
with(spr,
     plot(Height~BHDiameter, bg = "Blue", pch = 21, cex = mycex, 
     main = "RSS", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr))

with(spr,{segments(BHDiameter, Height, BHDiameter, yhat)})
abline(spruce.lm)

# Model Sum of Squares

with(spr,
     plot(Height~BHDiameter, bg = "Blue", pch = 21, cex = mycex, 
     main = "MSS", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr))
with(spr, abline(h = mean(Height)))
with(spr, {segments(BHDiameter, mean(Height), BHDiameter, yhat)})
abline(spruce.lm)

#Total Sum of Squares

with(spr,
     plot(Height~BHDiameter, bg = "Blue", pch=21, cex=mycex, 
     main = "TSS", ylab = "Height (m)", xlab = "BHDiameter (cm)",
     ylim=c(0, 1.1*max(Height)), xlim=c(0, 1.1*max(BHDiameter)), data = spr))
with(spr, abline(h = mean(Height)))
with(spr, segments(BHDiameter, Height, BHDiameter, mean(Height)))
```

## b Calculating RSS, MSS, and TSS

### Residual Sum of Squares

```{r}
RSS = with(spr, sum((Height-yhat)^2))
RSS
```

### Model Sum of Squares

```{r}
MSS = with(spr, sum((yhat - mean(Height))^2))
MSS
```

### Total Sum of Squares

```{r}
TSS = with(spr, sum((Height - mean(Height))^2))
TSS
```

## c MSS/TSS

```{r}
MSS/TSS
```

This is all the values of R squared. This value shows that a straight line is not the best fit for the scatterplot because it is not a large value.

## d TSS = RSS + MSS?

```{r}
RSS + MSS
```

That is equal to TSS.

# Task 5

## a. Summary

  spruce.lm summary

```{r}
summary(spruce.lm)
```

## b. Equation for the Line
  
```{r}
coef(spruce.lm)
```
  
  The slope is 0.4814743
  
  The intercept is 9.1468390
  
  The equation of the fitted line is
  Height = (0.4814743)x + 9.1468390
  
## c. Predictions

```{r}
predict(spruce.lm, data.frame(BHDiameter = c(15, 18, 20)))
```

# Task 6

```{r}
library(ggplot2)
g=ggplot(spr, aes(x = BHDiameter, y = Height, col = BHDiameter))
g = g+geom_point() + geom_line() + geom_smooth(method="lm")
g = g + ggtitle("Tree Height Vs BHDiameter")
g
```

# Task 7

![U. Kristine Nguyen - SLR](/Users/kristinenguyen/Documents/MATH 4753/Lab 3/SLR.png){width=85%}

![U. Kristine Nguyen - Scatterplot](/Users/kristinenguyen/Documents/MATH 4753/Lab 3/Scatterplot.png){width=85%}

![U. Kristine Nguyen - MSS](/Users/kristinenguyen/Documents/MATH 4753/Lab 3/MSS.png){width=80%}
